<!DOCTYPE html>
<html lang="en">
<head>
    <title>ActionController::RequestForgeryProtection::ClassMethods</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://api.rubyonrails.org/css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/github.css" type="text/css" media="screen" />
<script src="https://api.rubyonrails.org/js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="ActionController::RequestForgeryProtection::ClassMethods">

  

    <meta name="keywords" content="ActionController::RequestForgeryProtection::ClassMethods class">
  
    <meta name="keywords" content="protect_from_forgery, skip_forgery_protection">
  
</head>

<body>
    <div class="banner">
        
            <span>Ruby on Rails 5.2.1</span><br />
        
        <h1>
            <span class="type">Module</span>
            ActionController::RequestForgeryProtection::ClassMethods
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/actionpack/lib/action_controller/metal/request_forgery_protection_rb.html">actionpack/lib/action_controller/metal/request_forgery_protection.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-protect_from_forgery">protect_from_forgery</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-skip_forgery_protection">skip_forgery_protection</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-protect_from_forgery">
            
              <b>protect_from_forgery</b>(options = {})
            
            <a href="ClassMethods.html#method-i-protect_from_forgery" name="method-i-protect_from_forgery" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Turn on request forgery protection. Bear in mind that GET and HEAD requests
are not checked.</p>

<pre><code>class ApplicationController &lt; ActionController::Base
  protect_from_forgery
end

class FooController &lt; ApplicationController
  protect_from_forgery except: :index
end
</code></pre>

<p>You can disable forgery protection on controller by skipping the
verification before_action:</p>

<pre><code>skip_before_action :verify_authenticity_token
</code></pre>

<p>Valid Options:</p>
<ul><li>
<p><code>:only/:except</code> - Only apply forgery protection to a subset of
actions. For example <code>only: [ :create, :create_all ]</code>.</p>
</li><li>
<p><code>:if/:unless</code> - Turn off the forgery protection entirely
depending on the passed Proc or method reference.</p>
</li><li>
<p><code>:prepend</code> - By default, the verification of the authentication
token will be added at the position of the <a
href="ClassMethods.html#method-i-protect_from_forgery">#protect_from_forgery</a>
call in your application. This means any callbacks added before are run
first. This is useful when you want your forgery protection to depend on
other callbacks, like authentication methods (Oauth vs Cookie auth).</p>

<p>If you need to add verification to the beginning of the callback chain, use
<code>prepend: true</code>.</p>
</li><li>
<p><code>:with</code> - Set the method to handle unverified request.</p>
</li></ul>

<p>Valid unverified request handling methods are:</p>
<ul><li>
<p><code>:exception</code> - Raises ActionController::InvalidAuthenticityToken
exception.</p>
</li><li>
<p><code>:reset_session</code> - Resets the session.</p>
</li><li>
<p><code>:null_session</code> - Provides an empty session during request but
doesn&#39;t reset it completely. Used as default if <code>:with</code>
option is not specified.</p>
</li></ul>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-protect_from_forgery_source')" id="l_method-i-protect_from_forgery_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/actionpack/lib/action_controller/metal/request_forgery_protection.rb#L129" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-protect_from_forgery_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 129</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">protect_from_forgery</span>(<span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">reverse_merge</span>(<span class="ruby-value">prepend:</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">forgery_protection_strategy</span> = <span class="ruby-identifier">protection_method_class</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:with</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:null_session</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_forgery_protection_token</span> <span class="ruby-operator">||=</span> <span class="ruby-value">:authenticity_token</span>
  <span class="ruby-identifier">before_action</span> <span class="ruby-value">:verify_authenticity_token</span>, <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">append_after_action</span> <span class="ruby-value">:verify_same_origin_request</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-skip_forgery_protection">
            
              <b>skip_forgery_protection</b>(options = {})
            
            <a href="ClassMethods.html#method-i-skip_forgery_protection" name="method-i-skip_forgery_protection" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Turn off request forgery protection. This is a wrapper for:</p>

<pre><code>skip_before_action :verify_authenticity_token
</code></pre>

<p>See <code>skip_before_action</code> for allowed options.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-skip_forgery_protection_source')" id="l_method-i-skip_forgery_protection_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/actionpack/lib/action_controller/metal/request_forgery_protection.rb#L143" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-skip_forgery_protection_source" class="dyn-source">
                <pre><span class="ruby-comment"># File actionpack/lib/action_controller/metal/request_forgery_protection.rb, line 143</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_forgery_protection</span>(<span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">skip_before_action</span> <span class="ruby-value">:verify_authenticity_token</span>, <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
