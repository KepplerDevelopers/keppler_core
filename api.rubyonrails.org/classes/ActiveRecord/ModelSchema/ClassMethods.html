<!DOCTYPE html>
<html lang="en">
<head>
    <title>ActiveRecord::ModelSchema::ClassMethods</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://api.rubyonrails.org/css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/github.css" type="text/css" media="screen" />
<script src="https://api.rubyonrails.org/js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="ActiveRecord::ModelSchema::ClassMethods">

  

    <meta name="keywords" content="ActiveRecord::ModelSchema::ClassMethods class">
  
    <meta name="keywords" content="table_name, table_name=, quoted_table_name, protected_environments, protected_environments=, inheritance_column, inheritance_column=, ignored_columns, ignored_columns=, sequence_name, sequence_name=, prefetch_primary_key?, next_sequence_value, table_exists?, columns, type_for_attribute, column_defaults, column_names, content_columns, reset_column_information, initialize_load_schema_monitor, inherited, schema_loaded?, load_schema, load_schema!, reload_schema_from_cache, undecorated_table_name, compute_table_name">
  
</head>

<body>
    <div class="banner">
        
            <span>Ruby on Rails 5.2.1</span><br />
        
        <h1>
            <span class="type">Module</span>
            ActiveRecord::ModelSchema::ClassMethods
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activerecord/lib/active_record/model_schema_rb.html">activerecord/lib/active_record/model_schema.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-column_defaults">column_defaults</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-column_names">column_names</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-columns">columns</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-compute_table_name">compute_table_name</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-content_columns">content_columns</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-ignored_columns">ignored_columns</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-ignored_columns-3D">ignored_columns=</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-inheritance_column">inheritance_column</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-inheritance_column-3D">inheritance_column=</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-inherited">inherited</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-initialize_load_schema_monitor">initialize_load_schema_monitor</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-load_schema">load_schema</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-load_schema-21">load_schema!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-next_sequence_value">next_sequence_value</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-prefetch_primary_key-3F">prefetch_primary_key?</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-protected_environments">protected_environments</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-protected_environments-3D">protected_environments=</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>Q</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-quoted_table_name">quoted_table_name</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-reload_schema_from_cache">reload_schema_from_cache</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-reset_column_information">reset_column_information</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-schema_loaded-3F">schema_loaded?</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-sequence_name">sequence_name</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-sequence_name-3D">sequence_name=</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-table_exists-3F">table_exists?</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-table_name">table_name</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-table_name-3D">table_name=</a>,
              </li>
            
              
              <li>
                <a href="ClassMethods.html#method-i-type_for_attribute">type_for_attribute</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="ClassMethods.html#method-i-undecorated_table_name">undecorated_table_name</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-column_defaults">
            
              <b>column_defaults</b>()
            
            <a href="ClassMethods.html#method-i-column_defaults" name="method-i-column_defaults" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns a hash where the keys are column names and the values are default
values when instantiating the Active Record object for this table.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-column_defaults_source')" id="l_method-i-column_defaults_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L376" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-column_defaults_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 376</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_defaults</span>
  <span class="ruby-identifier">load_schema</span>
  <span class="ruby-ivar">@column_defaults</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_default_attributes</span>.<span class="ruby-identifier">to_hash</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-column_names">
            
              <b>column_names</b>()
            
            <a href="ClassMethods.html#method-i-column_names" name="method-i-column_names" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns an array of column names as strings.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-column_names_source')" id="l_method-i-column_names_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L387" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-column_names_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 387</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_names</span>
  <span class="ruby-ivar">@column_names</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-columns">
            
              <b>columns</b>()
            
            <a href="ClassMethods.html#method-i-columns" name="method-i-columns" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-columns_source')" id="l_method-i-columns_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L340" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-columns_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 340</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">columns</span>
  <span class="ruby-identifier">load_schema</span>
  <span class="ruby-ivar">@columns</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns_hash</span>.<span class="ruby-identifier">values</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-compute_table_name">
            
              <b>compute_table_name</b>()
            
            <a href="ClassMethods.html#method-i-compute_table_name" name="method-i-compute_table_name" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Computes and returns a table name according to default conventions.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-compute_table_name_source')" id="l_method-i-compute_table_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L503" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-compute_table_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 503</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_table_name</span>
  <span class="ruby-identifier">base</span> = <span class="ruby-identifier">base_class</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">base</span>
    <span class="ruby-comment"># Nested classes are prefixed with singular parent table name.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Base</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent</span>.<span class="ruby-identifier">abstract_class?</span>
      <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">table_name</span>
      <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">contained</span>.<span class="ruby-identifier">singularize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">pluralize_table_names</span>
      <span class="ruby-identifier">contained</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;_&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-node">&quot;#{full_table_name_prefix}#{contained}#{undecorated_table_name(name)}#{full_table_name_suffix}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># STI subclasses always use their superclass&#39; table.</span>
    <span class="ruby-identifier">base</span>.<span class="ruby-identifier">table_name</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-content_columns">
            
              <b>content_columns</b>()
            
            <a href="ClassMethods.html#method-i-content_columns" name="method-i-content_columns" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns an array of column objects where the primary id, all columns ending
in “_id” or “_count”, and columns used for single table inheritance have
been removed.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-content_columns_source')" id="l_method-i-content_columns_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L393" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-content_columns_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 393</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">content_columns</span>
  <span class="ruby-ivar">@content_columns</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">reject</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">primary_key</span> <span class="ruby-operator">||</span>
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">inheritance_column</span> <span class="ruby-operator">||</span>
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">&quot;_id&quot;</span>) <span class="ruby-operator">||</span>
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">&quot;_count&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ignored_columns">
            
              <b>ignored_columns</b>()
            
            <a href="ClassMethods.html#method-i-ignored_columns" name="method-i-ignored_columns" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>The list of columns names the model should ignore. Ignored columns
won&#39;t have attribute accessors defined, and won&#39;t be referenced in
SQL queries.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-ignored_columns_source')" id="l_method-i-ignored_columns_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L264" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-ignored_columns_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 264</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ignored_columns</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@ignored_columns</span>)
    <span class="ruby-ivar">@ignored_columns</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">ignored_columns</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ignored_columns-3D">
            
              <b>ignored_columns=</b>(columns)
            
            <a href="ClassMethods.html#method-i-ignored_columns-3D" name="method-i-ignored_columns-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Sets the columns names the model should ignore. Ignored columns won&#39;t
have attribute accessors defined, and won&#39;t be referenced in SQL
queries.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-ignored_columns-3D_source')" id="l_method-i-ignored_columns-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L274" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-ignored_columns-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 274</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ignored_columns=</span>(<span class="ruby-identifier">columns</span>)
  <span class="ruby-ivar">@ignored_columns</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-inheritance_column">
            
              <b>inheritance_column</b>()
            
            <a href="ClassMethods.html#method-i-inheritance_column" name="method-i-inheritance_column" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Defines the name of the table column which will store the class name on
single-table inheritance situations.</p>

<p>The default inheritance column name is <code>type</code>, which means
it&#39;s a reserved word inside Active Record. To be able to use
single-table inheritance with another column name, or to use the column
<code>type</code> in your own model for something else, you can set
<code>inheritance_column</code>:</p>

<pre><code>self.inheritance_column = &#39;zoink&#39;
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-inheritance_column_source')" id="l_method-i-inheritance_column_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L252" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-inheritance_column_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 252</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inheritance_column</span>
  (<span class="ruby-ivar">@inheritance_column</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">inheritance_column</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-inheritance_column-3D">
            
              <b>inheritance_column=</b>(value)
            
            <a href="ClassMethods.html#method-i-inheritance_column-3D" name="method-i-inheritance_column-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Sets the value of <a
href="ClassMethods.html#method-i-inheritance_column">#inheritance_column</a></p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-inheritance_column-3D_source')" id="l_method-i-inheritance_column-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L257" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-inheritance_column-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inheritance_column=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-ivar">@inheritance_column</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@explicit_inheritance_column</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-inherited">
            
              <b>inherited</b>(child_class)
            
            <a href="ClassMethods.html#method-i-inherited" name="method-i-inherited" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-inherited_source')" id="l_method-i-inherited_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L445" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-inherited_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 445</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inherited</span>(<span class="ruby-identifier">child_class</span>)
  <span class="ruby-keyword">super</span>
  <span class="ruby-identifier">child_class</span>.<span class="ruby-identifier">initialize_load_schema_monitor</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-initialize_load_schema_monitor">
            
              <b>initialize_load_schema_monitor</b>()
            
            <a href="ClassMethods.html#method-i-initialize_load_schema_monitor" name="method-i-initialize_load_schema_monitor" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-initialize_load_schema_monitor_source')" id="l_method-i-initialize_load_schema_monitor_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L439" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-initialize_load_schema_monitor_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize_load_schema_monitor</span>
  <span class="ruby-ivar">@load_schema_monitor</span> = <span class="ruby-constant">Monitor</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_schema">
            
              <b>load_schema</b>()
            
            <a href="ClassMethods.html#method-i-load_schema" name="method-i-load_schema" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-load_schema_source')" id="l_method-i-load_schema_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L454" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-load_schema_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 454</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_schema</span>
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">schema_loaded?</span>
        <span class="ruby-ivar">@load_schema_monitor</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword">do</span>
          <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@columns_hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@columns_hash</span>

          <span class="ruby-identifier">load_schema!</span>

          <span class="ruby-ivar">@schema_loaded</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_schema!</span>
        <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">columns_hash</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">except</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">ignored_columns</span>)
        <span class="ruby-ivar">@columns_hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">define_attribute</span>(
            <span class="ruby-identifier">name</span>,
            <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">lookup_cast_type_from_column</span>(<span class="ruby-identifier">column</span>),
            <span class="ruby-value">default:</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>,
            <span class="ruby-value">user_provided_default:</span> <span class="ruby-keyword">false</span>
          )
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reload_schema_from_cache</span>
        <span class="ruby-ivar">@arel_table</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@column_names</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@attribute_types</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@content_columns</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@default_attributes</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@column_defaults</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@inheritance_column</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@explicit_inheritance_column</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@explicit_inheritance_column</span>
        <span class="ruby-ivar">@attributes_builder</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@columns</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@schema_loaded</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-ivar">@attribute_names</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@yaml_encoder</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-identifier">direct_descendants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">descendant</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">descendant</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:reload_schema_from_cache</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Guesses the table name, but does not decorate it with prefix and suffix information.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">undecorated_table_name</span>(<span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">name</span>)
        <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">demodulize</span>.<span class="ruby-identifier">underscore</span>
        <span class="ruby-identifier">pluralize_table_names</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">table_name</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Computes and returns a table name according to default conventions.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_table_name</span>
        <span class="ruby-identifier">base</span> = <span class="ruby-identifier">base_class</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">base</span>
          <span class="ruby-comment"># Nested classes are prefixed with singular parent table name.</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Base</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent</span>.<span class="ruby-identifier">abstract_class?</span>
            <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">table_name</span>
            <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">contained</span>.<span class="ruby-identifier">singularize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">pluralize_table_names</span>
            <span class="ruby-identifier">contained</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;_&quot;</span>
          <span class="ruby-keyword">end</span>

          <span class="ruby-node">&quot;#{full_table_name_prefix}#{contained}#{undecorated_table_name(name)}#{full_table_name_suffix}&quot;</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-comment"># STI subclasses always use their superclass&#39; table.</span>
          <span class="ruby-identifier">base</span>.<span class="ruby-identifier">table_name</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_schema-21">
            
              <b>load_schema!</b>()
            
            <a href="ClassMethods.html#method-i-load_schema-21" name="method-i-load_schema-21" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-load_schema-21_source')" id="l_method-i-load_schema-21_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L465" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-load_schema-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 465</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_schema!</span>
  <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">columns_hash</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">except</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">ignored_columns</span>)
  <span class="ruby-ivar">@columns_hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">define_attribute</span>(
      <span class="ruby-identifier">name</span>,
      <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">lookup_cast_type_from_column</span>(<span class="ruby-identifier">column</span>),
      <span class="ruby-value">default:</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>,
      <span class="ruby-value">user_provided_default:</span> <span class="ruby-keyword">false</span>
    )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-next_sequence_value">
            
              <b>next_sequence_value</b>()
            
            <a href="ClassMethods.html#method-i-next_sequence_value" name="method-i-next_sequence_value" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the next value that will be used as the primary key on an insert
statement.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-next_sequence_value_source')" id="l_method-i-next_sequence_value_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L318" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-next_sequence_value_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 318</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">next_sequence_value</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">next_sequence_value</span>(<span class="ruby-identifier">sequence_name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-prefetch_primary_key-3F">
            
              <b>prefetch_primary_key?</b>()
            
            <a href="ClassMethods.html#method-i-prefetch_primary_key-3F" name="method-i-prefetch_primary_key-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Determines if the primary key values should be selected from their
corresponding sequence before the insert statement.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-prefetch_primary_key-3F_source')" id="l_method-i-prefetch_primary_key-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L312" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-prefetch_primary_key-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 312</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">prefetch_primary_key?</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">prefetch_primary_key?</span>(<span class="ruby-identifier">table_name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-protected_environments">
            
              <b>protected_environments</b>()
            
            <a href="ClassMethods.html#method-i-protected_environments" name="method-i-protected_environments" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>The array of names of environments where destructive actions should be
prohibited. By default, the value is <code>[&quot;production&quot;]</code>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-protected_environments_source')" id="l_method-i-protected_environments_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L230" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-protected_environments_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 230</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">protected_environments</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@protected_environments</span>)
    <span class="ruby-ivar">@protected_environments</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">protected_environments</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-protected_environments-3D">
            
              <b>protected_environments=</b>(environments)
            
            <a href="ClassMethods.html#method-i-protected_environments-3D" name="method-i-protected_environments-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Sets an array of names of environments where destructive actions should be
prohibited.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-protected_environments-3D_source')" id="l_method-i-protected_environments-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L239" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-protected_environments-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 239</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">protected_environments=</span>(<span class="ruby-identifier">environments</span>)
  <span class="ruby-ivar">@protected_environments</span> = <span class="ruby-identifier">environments</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-quoted_table_name">
            
              <b>quoted_table_name</b>()
            
            <a href="ClassMethods.html#method-i-quoted_table_name" name="method-i-quoted_table_name" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns a quoted version of the table name, used to construct SQL
statements.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-quoted_table_name_source')" id="l_method-i-quoted_table_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L205" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-quoted_table_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 205</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">quoted_table_name</span>
  <span class="ruby-ivar">@quoted_table_name</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">quote_table_name</span>(<span class="ruby-identifier">table_name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reload_schema_from_cache">
            
              <b>reload_schema_from_cache</b>()
            
            <a href="ClassMethods.html#method-i-reload_schema_from_cache" name="method-i-reload_schema_from_cache" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-reload_schema_from_cache_source')" id="l_method-i-reload_schema_from_cache_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L477" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-reload_schema_from_cache_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 477</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reload_schema_from_cache</span>
  <span class="ruby-ivar">@arel_table</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@column_names</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@attribute_types</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@content_columns</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@default_attributes</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@column_defaults</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@inheritance_column</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@explicit_inheritance_column</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@explicit_inheritance_column</span>
  <span class="ruby-ivar">@attributes_builder</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@columns</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@schema_loaded</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@attribute_names</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@yaml_encoder</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">direct_descendants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">descendant</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">descendant</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:reload_schema_from_cache</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reset_column_information">
            
              <b>reset_column_information</b>()
            
            <a href="ClassMethods.html#method-i-reset_column_information" name="method-i-reset_column_information" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Resets all the cached information about columns, which will cause them to
be reloaded on the next request.</p>

<p>The most common usage pattern for this method is probably in a migration,
when just after creating a table you want to populate it with some default
values, eg:</p>

<pre><code>class CreateJobLevels &lt; ActiveRecord::Migration[5.0]
  def up
    create_table :job_levels do |t|
      t.integer :id
      t.string :name

      t.timestamps
    end

    JobLevel.reset_column_information
    %w{assistant executive manager director}.each do |type|
      JobLevel.create(name: type)
    end
  end

  def down
    drop_table :job_levels
  end
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-reset_column_information_source')" id="l_method-i-reset_column_information_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L428" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-reset_column_information_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 428</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_column_information</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">clear_cache!</span>
  ([<span class="ruby-keyword">self</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">descendants</span>).<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:undefine_attribute_methods</span>)
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">clear_data_source_cache!</span>(<span class="ruby-identifier">table_name</span>)

  <span class="ruby-identifier">reload_schema_from_cache</span>
  <span class="ruby-identifier">initialize_find_by_cache</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-schema_loaded-3F">
            
              <b>schema_loaded?</b>()
            
            <a href="ClassMethods.html#method-i-schema_loaded-3F" name="method-i-schema_loaded-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-schema_loaded-3F_source')" id="l_method-i-schema_loaded-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L450" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-schema_loaded-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 450</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">schema_loaded?</span>
  <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@schema_loaded</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@schema_loaded</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sequence_name">
            
              <b>sequence_name</b>()
            
            <a href="ClassMethods.html#method-i-sequence_name" name="method-i-sequence_name" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-sequence_name_source')" id="l_method-i-sequence_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L278" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-sequence_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sequence_name</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">base_class</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>
    <span class="ruby-ivar">@sequence_name</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">reset_sequence_name</span>
  <span class="ruby-keyword">else</span>
    (<span class="ruby-ivar">@sequence_name</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">sequence_name</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sequence_name-3D">
            
              <b>sequence_name=</b>(value)
            
            <a href="ClassMethods.html#method-i-sequence_name-3D" name="method-i-sequence_name-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Sets the name of the sequence to use when generating ids to the given
value, or (if the value is <code>nil</code> or <code>false</code>) to the
value returned by the given block. This is required for Oracle and is
useful for any database which relies on sequences for primary key
generation.</p>

<p>If a sequence name is not explicitly set when using Oracle, it will default
to the commonly used pattern of: #{table_name}_seq</p>

<p>If a sequence name is not explicitly set when using PostgreSQL, it will
discover the sequence corresponding to your primary key for you.</p>

<pre><code>class Project &lt; ActiveRecord::Base
  self.sequence_name = &quot;projectseq&quot;   # default would have been &quot;project_seq&quot;
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-sequence_name-3D_source')" id="l_method-i-sequence_name-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L305" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-sequence_name-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 305</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sequence_name=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-ivar">@sequence_name</span>          = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@explicit_sequence_name</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-table_exists-3F">
            
              <b>table_exists?</b>()
            
            <a href="ClassMethods.html#method-i-table_exists-3F" name="method-i-table_exists-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Indicates whether the table associated with this class exists</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-table_exists-3F_source')" id="l_method-i-table_exists-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L323" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-table_exists-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 323</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_exists?</span>
  <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">data_source_exists?</span>(<span class="ruby-identifier">table_name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-table_name">
            
              <b>table_name</b>()
            
            <a href="ClassMethods.html#method-i-table_name" name="method-i-table_name" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Guesses the table name (in forced lower-case) based on the name of the
class in the inheritance hierarchy descending directly from <a
href="../Base.html">ActiveRecord::Base</a>. So if the hierarchy looks like:
Reply &lt; Message &lt; <a href="../Base.html">ActiveRecord::Base</a>, then
Message is used to guess the table name even when called on Reply. The
rules used to do the guess are handled by the Inflector class in Active
Support, which knows almost all common English inflections. You can add new
inflections in config/initializers/inflections.rb.</p>

<p>Nested classes are given table names prefixed by the singular form of the
parent&#39;s table name. Enclosing modules are not considered.</p>

<h4 id="method-i-table_name-label-Examples">Examples</h4>

<pre><code>class Invoice &lt; ActiveRecord::Base
end

file                  class               table_name
invoice.rb            Invoice             invoices

class Invoice &lt; ActiveRecord::Base
  class Lineitem &lt; ActiveRecord::Base
  end
end

file                  class               table_name
invoice.rb            Invoice::Lineitem   invoice_lineitems

module Invoice
  class Lineitem &lt; ActiveRecord::Base
  end
end

file                  class               table_name
invoice/lineitem.rb   Invoice::Lineitem   lineitems
</code></pre>

<p>Additionally, the class-level <code>table_name_prefix</code> is prepended
and the <code>table_name_suffix</code> is appended. So if you have “myapp_”
as a prefix, the table name guess for an Invoice class becomes
“myapp_invoices”. Invoice::Lineitem becomes “myapp_invoice_lineitems”.</p>

<p>You can also set your own table name explicitly:</p>

<pre><code>class Mouse &lt; ActiveRecord::Base
  self.table_name = &quot;mice&quot;
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-table_name_source')" id="l_method-i-table_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L179" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-table_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_name</span>
  <span class="ruby-identifier">reset_table_name</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@table_name</span>)
  <span class="ruby-ivar">@table_name</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-table_name-3D">
            
              <b>table_name=</b>(value)
            
            <a href="ClassMethods.html#method-i-table_name-3D" name="method-i-table_name-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Sets the table name explicitly. Example:</p>

<pre><code>class Project &lt; ActiveRecord::Base
  self.table_name = &quot;project&quot;
end
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-table_name-3D_source')" id="l_method-i-table_name-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L189" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-table_name-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 189</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_name=</span>(<span class="ruby-identifier">value</span>)
        <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>

        <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@table_name</span>)
          <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@table_name</span>
          <span class="ruby-identifier">reset_column_information</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">connected?</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-ivar">@table_name</span>        = <span class="ruby-identifier">value</span>
        <span class="ruby-ivar">@quoted_table_name</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@arel_table</span>        = <span class="ruby-keyword">nil</span>
        <span class="ruby-ivar">@sequence_name</span>     = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@explicit_sequence_name</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@explicit_sequence_name</span>
        <span class="ruby-ivar">@predicate_builder</span> = <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns a quoted version of the table name, used to construct SQL statements.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">quoted_table_name</span>
        <span class="ruby-ivar">@quoted_table_name</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">quote_table_name</span>(<span class="ruby-identifier">table_name</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Computes the table name, (re)sets it internally, and returns it.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_table_name</span> <span class="ruby-comment">#:nodoc:</span>
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">table_name</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">abstract_class?</span>
          <span class="ruby-identifier">superclass</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Base</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">table_name</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">abstract_class?</span>
          <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">table_name</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">compute_table_name</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">compute_table_name</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">full_table_name_prefix</span> <span class="ruby-comment">#:nodoc:</span>
        (<span class="ruby-identifier">parents</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:table_name_prefix</span>) } <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>).<span class="ruby-identifier">table_name_prefix</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">full_table_name_suffix</span> <span class="ruby-comment">#:nodoc:</span>
        (<span class="ruby-identifier">parents</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:table_name_suffix</span>) } <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>).<span class="ruby-identifier">table_name_suffix</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># The array of names of environments where destructive actions should be prohibited. By default,</span>
      <span class="ruby-comment"># the value is &lt;tt&gt;[&quot;production&quot;]&lt;/tt&gt;.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">protected_environments</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@protected_environments</span>)
          <span class="ruby-ivar">@protected_environments</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">protected_environments</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Sets an array of names of environments where destructive actions should be prohibited.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">protected_environments=</span>(<span class="ruby-identifier">environments</span>)
        <span class="ruby-ivar">@protected_environments</span> = <span class="ruby-identifier">environments</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Defines the name of the table column which will store the class name on single-table</span>
      <span class="ruby-comment"># inheritance situations.</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># The default inheritance column name is +type+, which means it&#39;s a</span>
      <span class="ruby-comment"># reserved word inside Active Record. To be able to use single-table</span>
      <span class="ruby-comment"># inheritance with another column name, or to use the column +type+ in</span>
      <span class="ruby-comment"># your own model for something else, you can set +inheritance_column+:</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#     self.inheritance_column = &#39;zoink&#39;</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inheritance_column</span>
        (<span class="ruby-ivar">@inheritance_column</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">inheritance_column</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Sets the value of inheritance_column</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inheritance_column=</span>(<span class="ruby-identifier">value</span>)
        <span class="ruby-ivar">@inheritance_column</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-ivar">@explicit_inheritance_column</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># The list of columns names the model should ignore. Ignored columns won&#39;t have attribute</span>
      <span class="ruby-comment"># accessors defined, and won&#39;t be referenced in SQL queries.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ignored_columns</span>
        <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@ignored_columns</span>)
          <span class="ruby-ivar">@ignored_columns</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">ignored_columns</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Sets the columns names the model should ignore. Ignored columns won&#39;t have attribute</span>
      <span class="ruby-comment"># accessors defined, and won&#39;t be referenced in SQL queries.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ignored_columns=</span>(<span class="ruby-identifier">columns</span>)
        <span class="ruby-ivar">@ignored_columns</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sequence_name</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">base_class</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>
          <span class="ruby-ivar">@sequence_name</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">reset_sequence_name</span>
        <span class="ruby-keyword">else</span>
          (<span class="ruby-ivar">@sequence_name</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">sequence_name</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_sequence_name</span> <span class="ruby-comment">#:nodoc:</span>
        <span class="ruby-ivar">@explicit_sequence_name</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-ivar">@sequence_name</span>          = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">default_sequence_name</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">primary_key</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Sets the name of the sequence to use when generating ids to the given</span>
      <span class="ruby-comment"># value, or (if the value is +nil+ or +false+) to the value returned by the</span>
      <span class="ruby-comment"># given block. This is required for Oracle and is useful for any</span>
      <span class="ruby-comment"># database which relies on sequences for primary key generation.</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># If a sequence name is not explicitly set when using Oracle,</span>
      <span class="ruby-comment"># it will default to the commonly used pattern of: #{table_name}_seq</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># If a sequence name is not explicitly set when using PostgreSQL, it</span>
      <span class="ruby-comment"># will discover the sequence corresponding to your primary key for you.</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#   class Project &lt; ActiveRecord::Base</span>
      <span class="ruby-comment">#     self.sequence_name = &quot;projectseq&quot;   # default would have been &quot;project_seq&quot;</span>
      <span class="ruby-comment">#   end</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sequence_name=</span>(<span class="ruby-identifier">value</span>)
        <span class="ruby-ivar">@sequence_name</span>          = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-ivar">@explicit_sequence_name</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Determines if the primary key values should be selected from their</span>
      <span class="ruby-comment"># corresponding sequence before the insert statement.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">prefetch_primary_key?</span>
        <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">prefetch_primary_key?</span>(<span class="ruby-identifier">table_name</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns the next value that will be used as the primary key on</span>
      <span class="ruby-comment"># an insert statement.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">next_sequence_value</span>
        <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">next_sequence_value</span>(<span class="ruby-identifier">sequence_name</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Indicates whether the table associated with this class exists</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">table_exists?</span>
        <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">data_source_exists?</span>(<span class="ruby-identifier">table_name</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">attributes_builder</span> <span class="ruby-comment"># :nodoc:</span>
        <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@attributes_builder</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@attributes_builder</span>
          <span class="ruby-identifier">defaults</span> = <span class="ruby-identifier">_default_attributes</span>.<span class="ruby-identifier">except</span>(<span class="ruby-operator">*</span>(<span class="ruby-identifier">column_names</span> <span class="ruby-operator">-</span> [<span class="ruby-identifier">primary_key</span>]))
          <span class="ruby-ivar">@attributes_builder</span> = <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">AttributeSet</span><span class="ruby-operator">::</span><span class="ruby-constant">Builder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attribute_types</span>, <span class="ruby-identifier">defaults</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-ivar">@attributes_builder</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">columns_hash</span> <span class="ruby-comment"># :nodoc:</span>
        <span class="ruby-identifier">load_schema</span>
        <span class="ruby-ivar">@columns_hash</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">columns</span>
        <span class="ruby-identifier">load_schema</span>
        <span class="ruby-ivar">@columns</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns_hash</span>.<span class="ruby-identifier">values</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">attribute_types</span> <span class="ruby-comment"># :nodoc:</span>
        <span class="ruby-identifier">load_schema</span>
        <span class="ruby-ivar">@attribute_types</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Type</span>.<span class="ruby-identifier">default_value</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">yaml_encoder</span> <span class="ruby-comment"># :nodoc:</span>
        <span class="ruby-ivar">@yaml_encoder</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">AttributeSet</span><span class="ruby-operator">::</span><span class="ruby-constant">YAMLEncoder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attribute_types</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns the type of the attribute with the given name, after applying</span>
      <span class="ruby-comment"># all modifiers. This method is the only valid source of information for</span>
      <span class="ruby-comment"># anything related to the types of a model&#39;s attributes. This method will</span>
      <span class="ruby-comment"># access the database and load the model&#39;s schema if it is required.</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># The return value of this method will implement the interface described</span>
      <span class="ruby-comment"># by ActiveModel::Type::Value (though the object itself may not subclass</span>
      <span class="ruby-comment"># it).</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># +attr_name+ The name of the attribute to retrieve the type for. Must be</span>
      <span class="ruby-comment"># a string or a symbol.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">type_for_attribute</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
        <span class="ruby-identifier">attr_name</span> = <span class="ruby-identifier">attr_name</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
          <span class="ruby-identifier">attribute_types</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">attribute_types</span>[<span class="ruby-identifier">attr_name</span>]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns a hash where the keys are column names and the values are</span>
      <span class="ruby-comment"># default values when instantiating the Active Record object for this table.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_defaults</span>
        <span class="ruby-identifier">load_schema</span>
        <span class="ruby-ivar">@column_defaults</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_default_attributes</span>.<span class="ruby-identifier">to_hash</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_default_attributes</span> <span class="ruby-comment"># :nodoc:</span>
        <span class="ruby-identifier">load_schema</span>
        <span class="ruby-ivar">@default_attributes</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">AttributeSet</span>.<span class="ruby-identifier">new</span>({})
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns an array of column names as strings.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_names</span>
        <span class="ruby-ivar">@column_names</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:name</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Returns an array of column objects where the primary id, all columns ending in &quot;_id&quot; or &quot;_count&quot;,</span>
      <span class="ruby-comment"># and columns used for single table inheritance have been removed.</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">content_columns</span>
        <span class="ruby-ivar">@content_columns</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">reject</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">primary_key</span> <span class="ruby-operator">||</span>
          <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">inheritance_column</span> <span class="ruby-operator">||</span>
          <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">&quot;_id&quot;</span>) <span class="ruby-operator">||</span>
          <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">&quot;_count&quot;</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Resets all the cached information about columns, which will cause them</span>
      <span class="ruby-comment"># to be reloaded on the next request.</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># The most common usage pattern for this method is probably in a migration,</span>
      <span class="ruby-comment"># when just after creating a table you want to populate it with some default</span>
      <span class="ruby-comment"># values, eg:</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#  class CreateJobLevels &lt; ActiveRecord::Migration[5.0]</span>
      <span class="ruby-comment">#    def up</span>
      <span class="ruby-comment">#      create_table :job_levels do |t|</span>
      <span class="ruby-comment">#        t.integer :id</span>
      <span class="ruby-comment">#        t.string :name</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#        t.timestamps</span>
      <span class="ruby-comment">#      end</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#      JobLevel.reset_column_information</span>
      <span class="ruby-comment">#      %w{assistant executive manager director}.each do |type|</span>
      <span class="ruby-comment">#        JobLevel.create(name: type)</span>
      <span class="ruby-comment">#      end</span>
      <span class="ruby-comment">#    end</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment">#    def down</span>
      <span class="ruby-comment">#      drop_table :job_levels</span>
      <span class="ruby-comment">#    end</span>
      <span class="ruby-comment">#  end</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_column_information</span>
        <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">clear_cache!</span>
        ([<span class="ruby-keyword">self</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">descendants</span>).<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:undefine_attribute_methods</span>)
        <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">clear_data_source_cache!</span>(<span class="ruby-identifier">table_name</span>)

        <span class="ruby-identifier">reload_schema_from_cache</span>
        <span class="ruby-identifier">initialize_find_by_cache</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">protected</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize_load_schema_monitor</span>
          <span class="ruby-ivar">@load_schema_monitor</span> = <span class="ruby-constant">Monitor</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">private</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inherited</span>(<span class="ruby-identifier">child_class</span>)
          <span class="ruby-keyword">super</span>
          <span class="ruby-identifier">child_class</span>.<span class="ruby-identifier">initialize_load_schema_monitor</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">schema_loaded?</span>
          <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@schema_loaded</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@schema_loaded</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_schema</span>
          <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">schema_loaded?</span>
          <span class="ruby-ivar">@load_schema_monitor</span>.<span class="ruby-identifier">synchronize</span> <span class="ruby-keyword">do</span>
            <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@columns_hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@columns_hash</span>

            <span class="ruby-identifier">load_schema!</span>

            <span class="ruby-ivar">@schema_loaded</span> = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_schema!</span>
          <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">schema_cache</span>.<span class="ruby-identifier">columns_hash</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">except</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">ignored_columns</span>)
          <span class="ruby-ivar">@columns_hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">define_attribute</span>(
              <span class="ruby-identifier">name</span>,
              <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">lookup_cast_type_from_column</span>(<span class="ruby-identifier">column</span>),
              <span class="ruby-value">default:</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">default</span>,
              <span class="ruby-value">user_provided_default:</span> <span class="ruby-keyword">false</span>
            )
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reload_schema_from_cache</span>
          <span class="ruby-ivar">@arel_table</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@column_names</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@attribute_types</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@content_columns</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@default_attributes</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@column_defaults</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@inheritance_column</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@explicit_inheritance_column</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@explicit_inheritance_column</span>
          <span class="ruby-ivar">@attributes_builder</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@columns</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@columns_hash</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@schema_loaded</span> = <span class="ruby-keyword">false</span>
          <span class="ruby-ivar">@attribute_names</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-ivar">@yaml_encoder</span> = <span class="ruby-keyword">nil</span>
          <span class="ruby-identifier">direct_descendants</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">descendant</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">descendant</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:reload_schema_from_cache</span>)
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Guesses the table name, but does not decorate it with prefix and suffix information.</span>
        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">undecorated_table_name</span>(<span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">name</span>)
          <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">demodulize</span>.<span class="ruby-identifier">underscore</span>
          <span class="ruby-identifier">pluralize_table_names</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">table_name</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Computes and returns a table name according to default conventions.</span>
        <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_table_name</span>
          <span class="ruby-identifier">base</span> = <span class="ruby-identifier">base_class</span>
          <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">base</span>
            <span class="ruby-comment"># Nested classes are prefixed with singular parent table name.</span>
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Base</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">parent</span>.<span class="ruby-identifier">abstract_class?</span>
              <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">table_name</span>
              <span class="ruby-identifier">contained</span> = <span class="ruby-identifier">contained</span>.<span class="ruby-identifier">singularize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">pluralize_table_names</span>
              <span class="ruby-identifier">contained</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;_&quot;</span>
            <span class="ruby-keyword">end</span>

            <span class="ruby-node">&quot;#{full_table_name_prefix}#{contained}#{undecorated_table_name(name)}#{full_table_name_suffix}&quot;</span>
          <span class="ruby-keyword">else</span>
            <span class="ruby-comment"># STI subclasses always use their superclass&#39; table.</span>
            <span class="ruby-identifier">base</span>.<span class="ruby-identifier">table_name</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-type_for_attribute">
            
              <b>type_for_attribute</b>(attr_name, &amp;block)
            
            <a href="ClassMethods.html#method-i-type_for_attribute" name="method-i-type_for_attribute" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the type of the attribute with the given name, after applying all
modifiers. This method is the only valid source of information for anything
related to the types of a model&#39;s attributes. This method will access
the database and load the model&#39;s schema if it is required.</p>

<p>The return value of this method will implement the interface described by
<a href="../../ActiveModel/Type/Value.html">ActiveModel::Type::Value</a>
(though the object itself may not subclass it).</p>

<p><code>attr_name</code> The name of the attribute to retrieve the type for.
Must be a string or a symbol.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-type_for_attribute_source')" id="l_method-i-type_for_attribute_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L365" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-type_for_attribute_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">type_for_attribute</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">attr_name</span> = <span class="ruby-identifier">attr_name</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">attribute_types</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">attr_name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">attribute_types</span>[<span class="ruby-identifier">attr_name</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-undecorated_table_name">
            
              <b>undecorated_table_name</b>(class_name = base_class.name)
            
            <a href="ClassMethods.html#method-i-undecorated_table_name" name="method-i-undecorated_table_name" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Guesses the table name, but does not decorate it with prefix and suffix
information.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-undecorated_table_name_source')" id="l_method-i-undecorated_table_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/model_schema.rb#L497" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-undecorated_table_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/model_schema.rb, line 497</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">undecorated_table_name</span>(<span class="ruby-identifier">class_name</span> = <span class="ruby-identifier">base_class</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">class_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">demodulize</span>.<span class="ruby-identifier">underscore</span>
  <span class="ruby-identifier">pluralize_table_names</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">table_name</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
