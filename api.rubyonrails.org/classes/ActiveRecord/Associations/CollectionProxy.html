<!DOCTYPE html>
<html lang="en">
<head>
    <title>ActiveRecord::Associations::CollectionProxy</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://api.rubyonrails.org/css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/github.css" type="text/css" media="screen" />
<script src="https://api.rubyonrails.org/js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="ActiveRecord::Associations::CollectionProxy">

  
    
    <meta name="description" content="Association proxies in Active Record are middlemen between the object that holds the association, known as the @owner, and the actual associated object, known as the @target.">
    <meta property="og:description" content="Association proxies in Active Record are middlemen between the object that holds the association, known as the @owner, and the actual associated object, known as the @target.">
  

    <meta name="keywords" content="ActiveRecord::Associations::CollectionProxy class">
  
    <meta name="keywords" content="target, load_target, loaded?, select, find, first, second, third, fourth, fifth, forty_two, third_to_last, second_to_last, last, take, build, new, create, create!, concat, replace, delete_all, destroy_all, delete, destroy, distinct, calculate, pluck, count, size, length, empty?, any?, many?, include?, proxy_association, scope, ==, <<, push, append, prepend, clear, reload, reset">
  
</head>

<body>
    <div class="banner">
        
            <span>Ruby on Rails 5.2.1</span><br />
        
        <h1>
            <span class="type">Class</span>
            ActiveRecord::Associations::CollectionProxy
            
                <span class="parent">&lt;
                    
                    Relation
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activerecord/lib/active_record/associations/collection_proxy_rb.html">activerecord/lib/active_record/associations/collection_proxy.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Association proxies in Active Record are middlemen between the object that
holds the association, known as the <code>@owner</code>, and the actual
associated object, known as the <code>@target</code>. The kind of
association any proxy is about is available in <code>@reflection</code>.
That&#39;s an instance of the class
ActiveRecord::Reflection::AssociationReflection.</p>

<p>For example, given</p>

<pre><code>class Blog &lt; ActiveRecord::Base
  has_many :posts
end

blog = Blog.first
</code></pre>

<p>the association proxy in <code>blog.posts</code> has the object in
<code>blog</code> as <code>@owner</code>, the collection of its posts as
<code>@target</code>, and the <code>@reflection</code> object represents a
<code>:has_many</code> macro.</p>

<p>This class delegates unknown methods to <code>@target</code> via
<code>method_missing</code>.</p>

<p>The <code>@target</code> object is not loaded until needed. For example,</p>

<pre><code>blog.posts.count
</code></pre>

<p>is computed directly through SQL and does not trigger by itself the
instantiation of the actual post records.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-3C-3C">&lt;&lt;</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-3D-3D">==</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-any-3F">any?</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-append">append</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-build">build</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-calculate">calculate</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-clear">clear</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-concat">concat</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-count">count</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-create">create</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-create-21">create!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-delete">delete</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-delete_all">delete_all</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-destroy">destroy</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-destroy_all">destroy_all</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-distinct">distinct</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-empty-3F">empty?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-fifth">fifth</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-find">find</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-first">first</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-forty_two">forty_two</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-fourth">fourth</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-include-3F">include?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-last">last</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-length">length</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-load_target">load_target</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-loaded-3F">loaded?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-many-3F">many?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-pluck">pluck</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-prepend">prepend</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-proxy_association">proxy_association</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-push">push</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-reload">reload</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-replace">replace</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-reset">reset</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-scope">scope</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-second">second</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-second_to_last">second_to_last</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-select">select</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-size">size</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-take">take</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-target">target</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-third">third</a>,
              </li>
            
              
              <li>
                <a href="CollectionProxy.html#method-i-third_to_last">third_to_last</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-3C-3C">
            
              <b>&lt;&lt;</b>(*records)
            
            <a href="CollectionProxy.html#method-i-3C-3C" name="method-i-3C-3C" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Adds one or more <code>records</code> to the collection by setting their
foreign keys to the association&#39;s primary key. Returns
<code>self</code>, so several appends may be chained together.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 0
person.pets &lt;&lt; Pet.new(name: &#39;Fancy-Fancy&#39;)
person.pets &lt;&lt; [Pet.new(name: &#39;Spook&#39;), Pet.new(name: &#39;Choo-Choo&#39;)]
person.pets.size # =&gt; 3

person.id # =&gt; 1
person.pets
# =&gt; [
#      #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="CollectionProxy.html#method-i-push">push</a>, <a href="CollectionProxy.html#method-i-append">append</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-3C-3C_source')" id="l_method-i-3C-3C_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L1055" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-3C-3C_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 1055</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">&lt;&lt;</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
  <span class="ruby-identifier">proxy_association</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">records</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-3D-3D">
            
              <b>==</b>(other)
            
            <a href="CollectionProxy.html#method-i-3D-3D" name="method-i-3D-3D" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Equivalent to <code>Array#==</code>. Returns <code>true</code> if the two
arrays contain the same number of elements and if each element is equal to
the corresponding element in the <code>other</code> array, otherwise
returns <code>false</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#      #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;
#    ]

other = person.pets.to_ary

person.pets == other
# =&gt; true

other = [Pet.new(id: 1), Pet.new(id: 2)]

person.pets == other
# =&gt; false
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-3D-3D_source')" id="l_method-i-3D-3D_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L987" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-3D-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 987</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-identifier">load_target</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-any-3F">
            
              <b>any?()
</b>
            
            <a href="CollectionProxy.html#method-i-any-3F" name="method-i-any-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns <code>true</code> if the collection is not empty.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.count # =&gt; 0
person.pets.any?  # =&gt; false

person.pets &lt;&lt; Pet.new(name: &#39;Snoop&#39;)
person.pets.count # =&gt; 1
person.pets.any?  # =&gt; true
</code></pre>

<p>You can also pass a <code>block</code> to define criteria. The behavior is
the same, it returns true if the collection based on the criteria is not
empty.</p>

<pre><code>person.pets
# =&gt; [#&lt;Pet name: &quot;Snoop&quot;, group: &quot;dogs&quot;&gt;]

person.pets.any? do |pet|
  pet.group == &#39;cats&#39;
end
# =&gt; false

person.pets.any? do |pet|
  pet.group == &#39;dogs&#39;
end
# =&gt; true
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-any-3F_source')" id="l_method-i-any-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L899" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-any-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 899</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-append">
            
              <b>append</b>(*records)
            
            <a href="CollectionProxy.html#method-i-append" name="method-i-append" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="CollectionProxy.html#method-i-3C-3C">&lt;&lt;</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-build">
            
              <b>build</b>(attributes = {}, &amp;block)
            
            <a href="CollectionProxy.html#method-i-build" name="method-i-build" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns a new object of the collection type that has been instantiated with
<code>attributes</code> and linked to this object, but have not yet been
saved. You can pass an array of attributes hashes, this will return an
array with the new objects.</p>

<pre><code>class Person
  has_many :pets
end

person.pets.build
# =&gt; #&lt;Pet id: nil, name: nil, person_id: 1&gt;

person.pets.build(name: &#39;Fancy-Fancy&#39;)
# =&gt; #&lt;Pet id: nil, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;

person.pets.build([{name: &#39;Spook&#39;}, {name: &#39;Choo-Choo&#39;}, {name: &#39;Brain&#39;}])
# =&gt; [
#      #&lt;Pet id: nil, name: &quot;Spook&quot;, person_id: 1&gt;,
#      #&lt;Pet id: nil, name: &quot;Choo-Choo&quot;, person_id: 1&gt;,
#      #&lt;Pet id: nil, name: &quot;Brain&quot;, person_id: 1&gt;
#    ]

person.pets.size  # =&gt; 5 # size of the collection
person.pets.count # =&gt; 0 # count from database
</code></pre>
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="CollectionProxy.html#method-i-new">new</a>
            </div>
          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-build_source')" id="l_method-i-build_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L318" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-build_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 318</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">build</span>(<span class="ruby-identifier">attributes</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-calculate">
            
              <b>calculate</b>(operation, column_name)
            
            <a href="CollectionProxy.html#method-i-calculate" name="method-i-calculate" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-calculate_source')" id="l_method-i-calculate_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L752" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-calculate_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 752</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">calculate</span>(<span class="ruby-identifier">operation</span>, <span class="ruby-identifier">column_name</span>)
  <span class="ruby-identifier">null_scope?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">calculate</span>(<span class="ruby-identifier">operation</span>, <span class="ruby-identifier">column_name</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear">
            
              <b>clear</b>()
            
            <a href="CollectionProxy.html#method-i-clear" name="method-i-clear" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Equivalent to <code>delete_all</code>. The difference is that returns
<code>self</code>, instead of an array with the deleted objects, so methods
can be chained. See <code>delete_all</code> for more information. Note that
because <code>delete_all</code> removes records by directly running an SQL
query into the database, the <code>updated_at</code> column of the object
is not changed.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-clear_source')" id="l_method-i-clear_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L1071" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-clear_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 1071</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear</span>
  <span class="ruby-identifier">delete_all</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-concat">
            
              <b>concat</b>(*records)
            
            <a href="CollectionProxy.html#method-i-concat" name="method-i-concat" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Add one or more records to the collection by setting their foreign keys to
the association&#39;s primary key. Since <a
href="CollectionProxy.html#method-i-3C-3C"><<</a> flattens its argument
list and inserts each record, <code>push</code> and <a
href="CollectionProxy.html#method-i-concat">concat</a> behave identically.
Returns <code>self</code> so method calls may be chained.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 0
person.pets.concat(Pet.new(name: &#39;Fancy-Fancy&#39;))
person.pets.concat(Pet.new(name: &#39;Spook&#39;), Pet.new(name: &#39;Choo-Choo&#39;))
person.pets.size # =&gt; 3

person.id # =&gt; 1
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.concat([Pet.new(name: &#39;Brain&#39;), Pet.new(name: &#39;Benny&#39;)])
person.pets.size # =&gt; 5
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-concat_source')" id="l_method-i-concat_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L393" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-concat_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 393</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">concat</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-count">
            
              <b>count(column_name = nil, &block)
</b>
            
            <a href="CollectionProxy.html#method-i-count" name="method-i-count" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Count all records.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

# This will perform the count using SQL.
person.pets.count # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>

<p>Passing a block will select all of a person&#39;s pets in SQL and then
perform the count using Ruby.</p>

<pre><code>person.pets.count { |pet| pet.name.include?(&#39;-&#39;) } # =&gt; 2
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-count_source')" id="l_method-i-count_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L786" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-count_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 786</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-create">
            
              <b>create</b>(attributes = {}, &amp;block)
            
            <a href="CollectionProxy.html#method-i-create" name="method-i-create" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns a new object of the collection type that has been instantiated with
attributes, linked to this object and that has already been saved (if it
passes the validations).</p>

<pre><code>class Person
  has_many :pets
end

person.pets.create(name: &#39;Fancy-Fancy&#39;)
# =&gt; #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;

person.pets.create([{name: &#39;Spook&#39;}, {name: &#39;Choo-Choo&#39;}])
# =&gt; [
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.size  # =&gt; 3
person.pets.count # =&gt; 3

person.pets.find(1, 2, 3)
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-create_source')" id="l_method-i-create_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L349" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 349</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create</span>(<span class="ruby-identifier">attributes</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-create-21">
            
              <b>create!</b>(attributes = {}, &amp;block)
            
            <a href="CollectionProxy.html#method-i-create-21" name="method-i-create-21" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Like <a href="CollectionProxy.html#method-i-create">create</a>, except that
if the record is invalid, raises an exception.</p>

<pre><code>class Person
  has_many :pets
end

class Pet
  validates :name, presence: true
end

person.pets.create!(name: nil)
# =&gt; ActiveRecord::RecordInvalid: Validation failed: Name can&#39;t be blank
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-create-21_source')" id="l_method-i-create-21_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L365" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-create-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create!</span>(<span class="ruby-identifier">attributes</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete">
            
              <b>delete</b>(*records)
            
            <a href="CollectionProxy.html#method-i-delete" name="method-i-delete" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Deletes the <code>records</code> supplied from the collection according to
the strategy specified by the <code>:dependent</code> option. If no
<code>:dependent</code> option is given, then it will follow the default
strategy. Returns an array with the deleted records.</p>

<p>For <code>has_many :through</code> associations, the default deletion
strategy is <code>:delete_all</code>.</p>

<p>For <code>has_many</code> associations, the default deletion strategy is
<code>:nullify</code>. This sets the foreign keys to <code>NULL</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets # dependent: :nullify option by default
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete(Pet.find(1))
# =&gt; [#&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;]

person.pets.size # =&gt; 2
person.pets
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

Pet.find(1)
# =&gt; #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: nil&gt;
</code></pre>

<p>If it is set to <code>:destroy</code> all the <code>records</code> are
removed by calling their <code>destroy</code> method. See
<code>destroy</code> for more information.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets, dependent: :destroy
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete(Pet.find(1), Pet.find(3))
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.size # =&gt; 1
person.pets
# =&gt; [#&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;]

Pet.find(1, 3)
# =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find all Pets with &#39;id&#39;: (1, 3)
</code></pre>

<p>If it is set to <code>:delete_all</code>, all the <code>records</code> are
deleted <strong>without</strong> calling their <code>destroy</code> method.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets, dependent: :delete_all
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete(Pet.find(1))
# =&gt; [#&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;]

person.pets.size # =&gt; 2
person.pets
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

Pet.find(1)
# =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find Pet with &#39;id&#39;=1
</code></pre>

<p>You can pass <code>Integer</code> or <code>String</code> values, it finds
the records responding to the <code>id</code> and executes delete on them.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete(&quot;1&quot;)
# =&gt; [#&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;]

person.pets.delete(2, 3)
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-delete_source')" id="l_method-i-delete_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L648" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 648</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete_all">
            
              <b>delete_all</b>(dependent = nil)
            
            <a href="CollectionProxy.html#method-i-delete_all" name="method-i-delete_all" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Deletes all the records from the collection according to the strategy
specified by the <code>:dependent</code> option. If no
<code>:dependent</code> option is given, then it will follow the default
strategy.</p>

<p>For <code>has_many :through</code> associations, the default deletion
strategy is <code>:delete_all</code>.</p>

<p>For <code>has_many</code> associations, the default deletion strategy is
<code>:nullify</code>. This sets the foreign keys to <code>NULL</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets # dependent: :nullify option by default
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete_all
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.size # =&gt; 0
person.pets      # =&gt; []

Pet.find(1, 2, 3)
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: nil&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: nil&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: nil&gt;
#    ]
</code></pre>

<p>Both <code>has_many</code> and <code>has_many :through</code> dependencies
default to the <code>:delete_all</code> strategy if the
<code>:dependent</code> option is set to <code>:destroy</code>. Records are
not instantiated and callbacks will not be fired.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets, dependent: :destroy
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete_all

Pet.find(1, 2, 3)
# =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find all Pets with &#39;id&#39;: (1, 2, 3)
</code></pre>

<p>If it is set to <code>:delete_all</code>, all the objects are deleted
<strong>without</strong> calling their <code>destroy</code> method.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets, dependent: :delete_all
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.delete_all

Pet.find(1, 2, 3)
# =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find all Pets with &#39;id&#39;: (1, 2, 3)
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-delete_all_source')" id="l_method-i-delete_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L502" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-delete_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 502</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete_all</span>(<span class="ruby-identifier">dependent</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">delete_all</span>(<span class="ruby-identifier">dependent</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-destroy">
            
              <b>destroy</b>(*records)
            
            <a href="CollectionProxy.html#method-i-destroy" name="method-i-destroy" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Destroys the <code>records</code> supplied and removes them from the
collection. This method will <em>always</em> remove record from the
database ignoring the <code>:dependent</code> option. Returns an array with
the removed records.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.destroy(Pet.find(1))
# =&gt; [#&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;]

person.pets.size # =&gt; 2
person.pets
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.destroy(Pet.find(2), Pet.find(3))
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.size  # =&gt; 0
person.pets       # =&gt; []

Pet.find(1, 2, 3) # =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find all Pets with &#39;id&#39;: (1, 2, 3)
</code></pre>

<p>You can pass <code>Integer</code> or <code>String</code> values, it finds
the records responding to the <code>id</code> and then deletes them from
the database.</p>

<pre><code>person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 4, name: &quot;Benny&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 5, name: &quot;Brain&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 6, name: &quot;Boss&quot;,  person_id: 1&gt;
#    ]

person.pets.destroy(&quot;4&quot;)
# =&gt; #&lt;Pet id: 4, name: &quot;Benny&quot;, person_id: 1&gt;

person.pets.size # =&gt; 2
person.pets
# =&gt; [
#       #&lt;Pet id: 5, name: &quot;Brain&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 6, name: &quot;Boss&quot;,  person_id: 1&gt;
#    ]

person.pets.destroy(5, 6)
# =&gt; [
#       #&lt;Pet id: 5, name: &quot;Brain&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 6, name: &quot;Boss&quot;,  person_id: 1&gt;
#    ]

person.pets.size  # =&gt; 0
person.pets       # =&gt; []

Pet.find(4, 5, 6) # =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find all Pets with &#39;id&#39;: (4, 5, 6)
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-destroy_source')" id="l_method-i-destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L720" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 720</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">destroy</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">records</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-destroy_all">
            
              <b>destroy_all</b>()
            
            <a href="CollectionProxy.html#method-i-destroy_all" name="method-i-destroy_all" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Deletes the records of the collection directly from the database ignoring
the <code>:dependent</code> option. Records are instantiated and it invokes
<code>before_remove</code>, <code>after_remove</code> ,
<code>before_destroy</code> and <code>after_destroy</code> callbacks.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 3
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.destroy_all

person.pets.size # =&gt; 0
person.pets      # =&gt; []

Pet.find(1) # =&gt; Couldn&#39;t find Pet with id=1
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-destroy_all_source')" id="l_method-i-destroy_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L529" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-destroy_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 529</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">destroy_all</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">destroy_all</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-distinct">
            
              <b>distinct(value = true)
</b>
            
            <a href="CollectionProxy.html#method-i-distinct" name="method-i-distinct" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Specifies whether the records should be unique or not.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.select(:name)
# =&gt; [
#      #&lt;Pet name: &quot;Fancy-Fancy&quot;&gt;,
#      #&lt;Pet name: &quot;Fancy-Fancy&quot;&gt;
#    ]

person.pets.select(:name).distinct
# =&gt; [#&lt;Pet name: &quot;Fancy-Fancy&quot;&gt;]

person.pets.select(:name).distinct.distinct(false)
# =&gt; [
#      #&lt;Pet name: &quot;Fancy-Fancy&quot;&gt;,
#      #&lt;Pet name: &quot;Fancy-Fancy&quot;&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-distinct_source')" id="l_method-i-distinct_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L751" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-distinct_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 751</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty-3F">
            
              <b>empty?</b>()
            
            <a href="CollectionProxy.html#method-i-empty-3F" name="method-i-empty-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns <code>true</code> if the collection is empty. If the collection has
been loaded it is equivalent to <code>collection.size.zero?</code>. If the
collection has not been loaded, it is equivalent to
<code>!collection.exists?</code>. If the collection has not already been
loaded and you are going to fetch the records anyway it is better to check
<code>collection.length.zero?</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.count  # =&gt; 1
person.pets.empty? # =&gt; false

person.pets.delete_all

person.pets.count  # =&gt; 0
person.pets.empty? # =&gt; true
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-empty-3F_source')" id="l_method-i-empty-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L859" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-empty-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 859</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">empty?</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fifth">
            
              <b>fifth()
</b>
            
            <a href="CollectionProxy.html#method-i-fifth" name="method-i-fifth" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the fifth record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-fifth_source')" id="l_method-i-fifth_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L208" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-fifth_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 208</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-find">
            
              <b>find</b>(*args)
            
            <a href="CollectionProxy.html#method-i-find" name="method-i-find" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Finds an object in the collection responding to the <code>id</code>. Uses
the same rules as ActiveRecord::Base.find. Returns <a
href="../RecordNotFound.html">ActiveRecord::RecordNotFound</a> error if the
object cannot be found.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.find(1) # =&gt; #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;
person.pets.find(4) # =&gt; ActiveRecord::RecordNotFound: Couldn&#39;t find Pet with &#39;id&#39;=4

person.pets.find(2) { |pet| pet.name.downcase! }
# =&gt; #&lt;Pet id: 2, name: &quot;fancy-fancy&quot;, person_id: 1&gt;

person.pets.find(2, 3)
# =&gt; [
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-find_source')" id="l_method-i-find_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L138" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-find_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-first">
            
              <b>first(limit = nil)
</b>
            
            <a href="CollectionProxy.html#method-i-first" name="method-i-first" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the first record, or the first <code>n</code> records, from the
collection. If the collection is empty, the first form returns
<code>nil</code>, and the second form returns an empty array.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.first # =&gt; #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;

person.pets.first(2)
# =&gt; [
#      #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;
#    ]

another_person_without.pets          # =&gt; []
another_person_without.pets.first    # =&gt; nil
another_person_without.pets.first(3) # =&gt; []
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-first_source')" id="l_method-i-first_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L176" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-first_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 176</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-forty_two">
            
              <b>forty_two()
</b>
            
            <a href="CollectionProxy.html#method-i-forty_two" name="method-i-forty_two" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the forty second record. Also known as accessing “the reddit”.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-forty_two_source')" id="l_method-i-forty_two_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L217" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-forty_two_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 217</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fourth">
            
              <b>fourth()
</b>
            
            <a href="CollectionProxy.html#method-i-fourth" name="method-i-fourth" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the fourth record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-fourth_source')" id="l_method-i-fourth_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L200" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-fourth_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 200</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-include-3F">
            
              <b>include?</b>(record)
            
            <a href="CollectionProxy.html#method-i-include-3F" name="method-i-include-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns <code>true</code> if the given <code>record</code> is present in
the collection.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets # =&gt; [#&lt;Pet id: 20, name: &quot;Snoop&quot;&gt;]

person.pets.include?(Pet.find(20)) # =&gt; true
person.pets.include?(Pet.find(21)) # =&gt; false
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-include-3F_source')" id="l_method-i-include-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L950" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-include-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 950</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include?</span>(<span class="ruby-identifier">record</span>)
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-ivar">@association</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">record</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-last">
            
              <b>last</b>(limit = nil)
            
            <a href="CollectionProxy.html#method-i-last" name="method-i-last" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the last record, or the last <code>n</code> records, from the
collection. If the collection is empty, the first form returns
<code>nil</code>, and the second form returns an empty array.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.last # =&gt; #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;

person.pets.last(2)
# =&gt; [
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

another_person_without.pets         # =&gt; []
another_person_without.pets.last    # =&gt; nil
another_person_without.pets.last(3) # =&gt; []
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-last_source')" id="l_method-i-last_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L259" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-last_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 259</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last</span>(<span class="ruby-identifier">limit</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">load_target</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">find_from_target?</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-length">
            
              <b>length()
</b>
            
            <a href="CollectionProxy.html#method-i-length" name="method-i-length" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the size of the collection calling <code>size</code> on the target.
If the collection has been already loaded, <code>length</code> and
<code>size</code> are equivalent. If not and you are going to need the
records anyway this method will take one less query. Otherwise
<code>size</code> is more efficient.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.length # =&gt; 3
# executes something like SELECT &quot;pets&quot;.* FROM &quot;pets&quot; WHERE &quot;pets&quot;.&quot;person_id&quot; = 1

# Because the collection is loaded, you can
# call the collection with no additional queries:
person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-length_source')" id="l_method-i-length_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L841" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-length_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 841</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_target">
            
              <b>load_target</b>()
            
            <a href="CollectionProxy.html#method-i-load_target" name="method-i-load_target" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-load_target_source')" id="l_method-i-load_target_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L45" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-load_target_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_target</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">load_target</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-loaded-3F">
            
              <b>loaded?</b>()
            
            <a href="CollectionProxy.html#method-i-loaded-3F" name="method-i-loaded-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns <code>true</code> if the association has been loaded, otherwise
<code>false</code>.</p>

<pre><code>person.pets.loaded? # =&gt; false
person.pets
person.pets.loaded? # =&gt; true
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-loaded-3F_source')" id="l_method-i-loaded-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L54" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-loaded-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">loaded?</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">loaded?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-many-3F">
            
              <b>many?()
</b>
            
            <a href="CollectionProxy.html#method-i-many-3F" name="method-i-many-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns true if the collection has more than one record. Equivalent to
<code>collection.size &gt; 1</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.count # =&gt; 1
person.pets.many? # =&gt; false

person.pets &lt;&lt; Pet.new(name: &#39;Snoopy&#39;)
person.pets.count # =&gt; 2
person.pets.many? # =&gt; true
</code></pre>

<p>You can also pass a <code>block</code> to define criteria. The behavior is
the same, it returns true if the collection based on the criteria has more
than one record.</p>

<pre><code>person.pets
# =&gt; [
#      #&lt;Pet name: &quot;Gorby&quot;, group: &quot;cats&quot;&gt;,
#      #&lt;Pet name: &quot;Puff&quot;, group: &quot;cats&quot;&gt;,
#      #&lt;Pet name: &quot;Snoop&quot;, group: &quot;dogs&quot;&gt;
#    ]

person.pets.many? do |pet|
  pet.group == &#39;dogs&#39;
end
# =&gt; false

person.pets.many? do |pet|
  pet.group == &#39;cats&#39;
end
# =&gt; true
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-many-3F_source')" id="l_method-i-many-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L940" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-many-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 940</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-new">
            
              <b>new</b>(attributes = {}, &amp;block)
            
            <a href="CollectionProxy.html#method-i-new" name="method-i-new" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="CollectionProxy.html#method-i-build">build</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-pluck">
            
              <b>pluck</b>(*column_names)
            
            <a href="CollectionProxy.html#method-i-pluck" name="method-i-pluck" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-pluck_source')" id="l_method-i-pluck_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L756" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-pluck_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 756</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pluck</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">column_names</span>)
  <span class="ruby-identifier">null_scope?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">pluck</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">column_names</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-prepend">
            
              <b>prepend</b>(*args)
            
            <a href="CollectionProxy.html#method-i-prepend" name="method-i-prepend" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-prepend_source')" id="l_method-i-prepend_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L1061" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-prepend_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 1061</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">prepend</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-string">&quot;prepend on association is not defined. Please use &lt;&lt;, push or append&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-proxy_association">
            
              <b>proxy_association</b>()
            
            <a href="CollectionProxy.html#method-i-proxy_association" name="method-i-proxy_association" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-proxy_association_source')" id="l_method-i-proxy_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L954" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-proxy_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 954</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">proxy_association</span>
  <span class="ruby-ivar">@association</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-push">
            
              <b>push</b>(*records)
            
            <a href="CollectionProxy.html#method-i-push" name="method-i-push" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="CollectionProxy.html#method-i-3C-3C">&lt;&lt;</a>
            </div>
          

          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reload">
            
              <b>reload</b>()
            
            <a href="CollectionProxy.html#method-i-reload" name="method-i-reload" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Reloads the collection from the database. Returns <code>self</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets # fetches pets from the database
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]

person.pets # uses the pets cache
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]

person.pets.reload # fetches pets from the database
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-reload_source')" id="l_method-i-reload_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L1090" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-reload_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 1090</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reload</span>
  <span class="ruby-identifier">proxy_association</span>.<span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">reset_scope</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-replace">
            
              <b>replace</b>(other_array)
            
            <a href="CollectionProxy.html#method-i-replace" name="method-i-replace" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Replaces this collection with <code>other_array</code>. This will perform a
diff and delete/add only records that have changed.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [#&lt;Pet id: 1, name: &quot;Gorby&quot;, group: &quot;cats&quot;, person_id: 1&gt;]

other_pets = [Pet.new(name: &#39;Puff&#39;, group: &#39;celebrities&#39;]

person.pets.replace(other_pets)

person.pets
# =&gt; [#&lt;Pet id: 2, name: &quot;Puff&quot;, group: &quot;celebrities&quot;, person_id: 1&gt;]
</code></pre>

<p>If the supplied array has an incorrect association type, it raises an
<code>ActiveRecord::AssociationTypeMismatch</code> error:</p>

<pre><code>person.pets.replace([&quot;doo&quot;, &quot;ggie&quot;, &quot;gaga&quot;])
# =&gt; ActiveRecord::AssociationTypeMismatch: Pet expected, got String
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-replace_source')" id="l_method-i-replace_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L419" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-replace_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 419</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">replace</span>(<span class="ruby-identifier">other_array</span>)
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">other_array</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reset">
            
              <b>reset</b>()
            
            <a href="CollectionProxy.html#method-i-reset" name="method-i-reset" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Unloads the association. Returns <code>self</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets # fetches pets from the database
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]

person.pets # uses the pets cache
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]

person.pets.reset # clears the pets cache

person.pets  # fetches pets from the database
# =&gt; [#&lt;Pet id: 1, name: &quot;Snoop&quot;, group: &quot;dogs&quot;, person_id: 1&gt;]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-reset_source')" id="l_method-i-reset_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L1111" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-reset_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 1111</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset</span>
  <span class="ruby-identifier">proxy_association</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-identifier">proxy_association</span>.<span class="ruby-identifier">reset_scope</span>
  <span class="ruby-identifier">reset_scope</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-scope">
            
              <b>scope</b>()
            
            <a href="CollectionProxy.html#method-i-scope" name="method-i-scope" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns a <code>Relation</code> object for the records in this association</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-scope_source')" id="l_method-i-scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L959" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 959</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">scope</span>
  <span class="ruby-ivar">@scope</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">scope</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-second">
            
              <b>second()
</b>
            
            <a href="CollectionProxy.html#method-i-second" name="method-i-second" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the second record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-second_source')" id="l_method-i-second_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L184" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-second_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 184</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-second_to_last">
            
              <b>second_to_last()
</b>
            
            <a href="CollectionProxy.html#method-i-second_to_last" name="method-i-second_to_last" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the second-to-last record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-second_to_last_source')" id="l_method-i-second_to_last_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L233" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-second_to_last_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 233</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-select">
            
              <b>select(*fields, &block)
</b>
            
            <a href="CollectionProxy.html#method-i-select" name="method-i-select" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Works in two ways.</p>

<p><strong>First:</strong> Specify a subset of fields to be selected from the
result set.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.select(:name)
# =&gt; [
#      #&lt;Pet id: nil, name: &quot;Fancy-Fancy&quot;&gt;,
#      #&lt;Pet id: nil, name: &quot;Spook&quot;&gt;,
#      #&lt;Pet id: nil, name: &quot;Choo-Choo&quot;&gt;
#    ]

person.pets.select(:id, :name)
# =&gt; [
#      #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;&gt;,
#      #&lt;Pet id: 2, name: &quot;Spook&quot;&gt;,
#      #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;&gt;
#    ]
</code></pre>

<p>Be careful because this also means you&#39;re initializing a model object
with only the fields that you&#39;ve selected. If you attempt to access a
field except <code>id</code> that is not in the initialized record
you&#39;ll receive:</p>

<pre><code>person.pets.select(:name).first.person_id
# =&gt; ActiveModel::MissingAttributeError: missing attribute: person_id
</code></pre>

<p><strong>Second:</strong> You can pass a block so it can be used just like
Array#select. This builds an array of objects from the database for the
scope, converting them into an array and iterating through them using
Array#select.</p>

<pre><code>person.pets.select { |pet| pet.name =~ /oo/ }
# =&gt; [
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-select_source')" id="l_method-i-select_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L112" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-select_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 112</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-size">
            
              <b>size</b>()
            
            <a href="CollectionProxy.html#method-i-size" name="method-i-size" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Returns the size of the collection. If the collection hasn&#39;t been
loaded, it executes a <code>SELECT COUNT(*)</code> query. Else it calls
<code>collection.size</code>.</p>

<p>If the collection has been already loaded <code>size</code> and
<code>length</code> are equivalent. If not and you are going to need the
records anyway <code>length</code> will take one less query. Otherwise
<code>size</code> is more efficient.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets.size # =&gt; 3
# executes something like SELECT COUNT(*) FROM &quot;pets&quot; WHERE &quot;pets&quot;.&quot;person_id&quot; = 1

person.pets # This will execute a SELECT * FROM query
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.size # =&gt; 3
# Because the collection is already loaded, this will behave like
# collection.size and no SQL count query is executed.
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-size_source')" id="l_method-i-size_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L810" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-size_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 810</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">size</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-take">
            
              <b>take</b>(limit = nil)
            
            <a href="CollectionProxy.html#method-i-take" name="method-i-take" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Gives a record (or N records if a parameter is supplied) from the
collection using the same rules as <code>ActiveRecord::Base.take</code>.</p>

<pre><code>class Person &lt; ActiveRecord::Base
  has_many :pets
end

person.pets
# =&gt; [
#       #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;,
#       #&lt;Pet id: 3, name: &quot;Choo-Choo&quot;, person_id: 1&gt;
#    ]

person.pets.take # =&gt; #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;

person.pets.take(2)
# =&gt; [
#      #&lt;Pet id: 1, name: &quot;Fancy-Fancy&quot;, person_id: 1&gt;,
#      #&lt;Pet id: 2, name: &quot;Spook&quot;, person_id: 1&gt;
#    ]

another_person_without.pets         # =&gt; []
another_person_without.pets.take    # =&gt; nil
another_person_without.pets.take(2) # =&gt; []
</code></pre>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-take_source')" id="l_method-i-take_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L289" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-take_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">take</span>(<span class="ruby-identifier">limit</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">load_target</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">find_from_target?</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-target">
            
              <b>target</b>()
            
            <a href="CollectionProxy.html#method-i-target" name="method-i-target" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-target_source')" id="l_method-i-target_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L41" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-target_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">target</span>
  <span class="ruby-ivar">@association</span>.<span class="ruby-identifier">target</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-third">
            
              <b>third()
</b>
            
            <a href="CollectionProxy.html#method-i-third" name="method-i-third" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the third record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-third_source')" id="l_method-i-third_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L192" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-third_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 192</span>
      </pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-third_to_last">
            
              <b>third_to_last()
</b>
            
            <a href="CollectionProxy.html#method-i-third_to_last" name="method-i-third_to_last" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Same as <a href="CollectionProxy.html#method-i-first">first</a> except
returns only the third-to-last record.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-third_to_last_source')" id="l_method-i-third_to_last_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/fc5dd0b85189811062c85520fd70de8389b55aeb/activerecord/lib/active_record/associations/collection_proxy.rb#L225" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-third_to_last_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/associations/collection_proxy.rb, line 225</span>
      </pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
