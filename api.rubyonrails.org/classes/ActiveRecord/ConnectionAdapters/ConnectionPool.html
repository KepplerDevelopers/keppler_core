<!DOCTYPE html>
<html lang="en">
<head>
    <title>ActiveRecord::ConnectionAdapters::ConnectionPool</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://api.rubyonrails.org/css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="https://api.rubyonrails.org/css/github.css" type="text/css" media="screen" />
<script src="https://api.rubyonrails.org/js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="https://api.rubyonrails.org/js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="ActiveRecord::ConnectionAdapters::ConnectionPool">

  
    
    <meta name="description" content="Connection pool base class for managing Active Record database connections.  Introduction  A connection pool synchronizes thread access to a limited number of database connections.">
    <meta property="og:description" content="Connection pool base class for managing Active Record database connections.  Introduction  A connection pool synchronizes thread access to a limited number of database connections.">
  

    <meta name="keywords" content="ActiveRecord::ConnectionAdapters::ConnectionPool class">
  
</head>

<body>
    <div class="banner">
        
            <span>Ruby on Rails 5.2.1</span><br />
        
        <h1>
            <span class="type">Class</span>
            ActiveRecord::ConnectionAdapters::ConnectionPool
            
                <span class="parent">&lt;
                    
                    <a href="https://api.rubyonrails.org/classes/Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activerecord/lib/active_record/connection_adapters/abstract/connection_pool_rb.html">activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Connection pool base class for managing Active Record database connections.</p>

<h2 id="class-ActiveRecord::ConnectionAdapters::ConnectionPool-label-Introduction">Introduction</h2>

<p>A connection pool synchronizes thread access to a limited number of
database connections. The basic idea is that each thread checks out a
database connection from the pool, uses that connection, and checks the
connection back in. <a href="ConnectionPool.html">ConnectionPool</a> is
completely thread-safe, and will ensure that a connection cannot be used by
two threads at the same time, as long as ConnectionPool&#39;s contract is
correctly followed. It will also handle cases in which there are more
threads than connections: if all connections have been checked out, and a
thread tries to checkout a connection anyway, then <a
href="ConnectionPool.html">ConnectionPool</a> will wait until some other
thread has checked in a connection.</p>

<h2 id="class-ActiveRecord::ConnectionAdapters::ConnectionPool-label-Obtaining+-28checking+out-29+a+connection">Obtaining (checking out) a connection</h2>

<p>Connections can be obtained and used from a connection pool in several
ways:</p>
<ol><li>
<p>Simply use <a
href="../ConnectionHandling.html#method-i-connection">ActiveRecord::Base.connection</a>
as with Active Record 2.1 and earlier (pre-connection-pooling). Eventually,
when you&#39;re done with the connection(s) and wish it to be returned to
the pool, you call ActiveRecord::Base.clear_active_connections!. This will
be the default behavior for Active Record when used in conjunction with
Action Pack&#39;s request handling cycle.</p>
</li><li>
<p>Manually check out a connection from the pool with
ActiveRecord::Base.connection_pool.checkout. You are responsible for
returning this connection to the pool when finished by calling
ActiveRecord::Base.connection_pool.checkin(connection).</p>
</li><li>
<p>Use ActiveRecord::Base.connection_pool.with_connection(&block), which
obtains a connection, yields it as the sole argument to the block, and
returns it to the pool after the block completes.</p>
</li></ol>

<p>Connections in the pool are actually <a
href="AbstractAdapter.html">AbstractAdapter</a> objects (or objects
compatible with AbstractAdapter&#39;s interface).</p>

<h2 id="class-ActiveRecord::ConnectionAdapters::ConnectionPool-label-Options">Options</h2>

<p>There are several connection-pooling-related options that you can add to
your database connection configuration:</p>
<ul><li>
<p><code>pool</code>: maximum number of connections the pool may manage
(default 5).</p>
</li><li>
<p><code>idle_timeout</code>: number of seconds that a connection will be kept
unused in the pool before it is automatically disconnected (default 300
seconds). Set this to zero to keep connections forever.</p>
</li><li>
<p><code>checkout_timeout</code>: number of seconds to wait for a connection
to become available before giving up and raising a timeout error (default 5
seconds).</p>
</li></ul>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">CLASS</span>
          <a href="ConnectionPool/Queue.html">ActiveRecord::ConnectionAdapters::ConnectionPool::Queue</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="ConnectionPool/Reaper.html">ActiveRecord::ConnectionAdapters::ConnectionPool::Reaper</a>
        </li>
      
    </ul>
  


  

  



  

    

    

    


    


    <!-- Methods -->
    
    
    
  
</div>

    </div>
  </body>
</html>
