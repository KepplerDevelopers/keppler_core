= simple_form_for @role, url: admin_role_create_permissions_path(role), method: :post do |f|
  = parent
  = module_name
  %label
    - if !role.children_have_action?(module_name, parent, action)
      .switch.pull-right
        %input{name: "role[module]", type: "hidden", value: module_name}
        %input{name: "role[children]", type: "hidden", value: "#{children}"}
        %input{name: "role[action]", type: "hidden", value: action}
        %input{name: "role[parent]", type: "hidden", value: parent}
        %input{id: "switch-children-#{module_name}-#{action}", type: "checkbox"}/
        %label.label-default{:for => "switch-children-#{module_name}-#{action}-children", onclick: "sendPermissions('#{module_name}', '#{action}')"}

    - else
      .switch.pull-right
        %input{name: "role[module]", type: "hidden", value: module_name}
        %input{name: "role[children]", type: "hidden", value: "#{children}"}
        %input{name: "role[action]", type: "hidden", value: action}
        %input{name: "role[parent]", type: "hidden", value: parent}
        %input{id: "switch-children-#{module_name}-#{action}", type: "checkbox",  checked: "checked"}/
        %label.label-default{:for => "switch-children-#{module_name}-#{action}", onclick: "sendPermissions('#{module_name}', '#{action}')"}

:javascript
  function sendPermissions(module_name, action) {
    $('#switch-children-'+module_name+'-'+action).parent().parent().parent().submit()
  }
